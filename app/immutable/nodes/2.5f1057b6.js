import{s as fe,p as we,E as Ve,F as Le,f as C,a as N,g as E,h as L,y as re,c as A,d,j as m,r as Gt,i as O,u as _,G as Ye,H as ke,I as xe,J as ct,l as oe,m as ie,v as Y,K as ye,L as on,o as ot,M as it,w as an,A as cn,B as un,C as fn,n as Oe,e as Ce,k as ze,D as me,N as Xe,z as Ge,O as pn,P as Ut,Q as _t,x as _n}from"../chunks/scheduler.876e21ab.js";import{S as pe,i as _e,f as Fe,b as R,d as V,m as F,a as b,t as k,e as M,g as ce,c as ue,h as dn}from"../chunks/index.bf870a3d.js";import{g as mn}from"../chunks/globals.7f7f1b26.js";import{e as Te}from"../chunks/each.e59479a4.js";import{D as Ht,a as qt,r as Kt}from"../chunks/result-columns-store.d28c04bd.js";import{T as He}from"../chunks/TextButton.e107ec77.js";import{D as gn}from"../chunks/DetailedTag.e8adca40.js";import{K as hn,A as $n}from"../chunks/ActiveTagList.1280392f.js";import{b as Wt}from"../chunks/paths.4aa6f1c5.js";import{f as Me}from"../chunks/format-tag.7e313273.js";import{r as Ze,a as ut}from"../chunks/active-supertags-store.b1bbef2c.js";import{I as vn,R as bn}from"../chunks/ModifierSelect.c4603b4a.js";import{h as dt,u as kn}from"../chunks/await_block.ac7187f4.js";import{L as pt}from"../chunks/LoadingAnimation.a4beb55c.js";import{R as wn,S as Jt,a as Qt,K as Yt,E as Zt,b as yn,g as mt,P as Xt,C as Cn,c as En,d as xt,i as Sn,e as en,G as In,V as Dn,f as gt,I as Tn,h as Pn}from"../chunks/Gif.61d69835.js";import{a as Nn}from"../chunks/always-loop-store.309dbd9e.js";import{f as Be,s as Ue,S as An}from"../chunks/search-builder.8b9a057a.js";import{S as ht}from"../chunks/Select.114fd047.js";import{R as On}from"../chunks/RotatingTextSelect.0ba9b844.js";import{S as Rn}from"../chunks/Searchbar.07504810.js";import{S as Vn}from"../chunks/ScrollUpButton.a1064122.js";import{g as Fn,a as Mn}from"../chunks/tags.49324235.js";import{l as Ln}from"../chunks/analytics.b280da65.js";import{n as jn,s as $t}from"../chunks/supertags-store.8754cbe2.js";import{a as at}from"../chunks/active-tags-store.9b7ddb3d.js";import{b as Bn}from"../chunks/blocked-content-store.8a17b05d.js";import{c as tn}from"../chunks/cookies-accepted-store.27e787be.js";function vt(l,e,n){const t=l.slice();return t[11]=e[n],t}function bt(l){let e,n;return e=new gn({props:{tag:l[11]}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&8&&(o.tag=t[11]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function zn(l){let e;return{c(){e=oe("Create supertag")},l(n){e=ie(n,"Create supertag")},m(n,t){O(n,e,t)},d(n){n&&d(e)}}}function Gn(l){let e,n,t="Create Supertag",s,o,r,a,i,c="Name",u,p,f,w,g,y="Description",G,$,v,h,P,U="Tags",J,B,T,S,D,j,I,ee,Q=Te(l[3]),z=[];for(let H=0;H<Q.length;H+=1)z[H]=bt(vt(l,Q,H));const le=H=>k(z[H],1,1,()=>{z[H]=null});return D=new He({props:{title:l[4]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[4],$$slots:{default:[zn]},$$scope:{ctx:l}}}),D.$on("click",l[9]),{c(){e=C("section"),n=C("h3"),n.textContent=t,s=N(),o=C("button"),r=N(),a=C("div"),i=C("label"),i.textContent=c,u=N(),p=C("input"),f=N(),w=C("div"),g=C("label"),g.textContent=y,G=N(),$=C("input"),v=N(),h=C("div"),P=C("span"),P.textContent=U,J=N(),B=C("ol");for(let H=0;H<z.length;H+=1)z[H].c();T=N(),S=C("div"),R(D.$$.fragment),this.h()},l(H){e=E(H,"SECTION",{class:!0});var q=L(e);n=E(q,"H3",{"data-svelte-h":!0}),re(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=A(q),o=E(q,"BUTTON",{class:!0}),L(o).forEach(d),r=A(q),a=E(q,"DIV",{class:!0});var ne=L(a);i=E(ne,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(i)!=="svelte-10k8a68"&&(i.textContent=c),u=A(ne),p=E(ne,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),ne.forEach(d),f=A(q),w=E(q,"DIV",{class:!0});var X=L(w);g=E(X,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(g)!=="svelte-14n9kp6"&&(g.textContent=y),G=A(X),$=E(X,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),X.forEach(d),v=A(q),h=E(q,"DIV",{class:!0});var ge=L(h);P=E(ge,"SPAN",{class:!0,"data-svelte-h":!0}),re(P)!=="svelte-7hjyox"&&(P.textContent=U),J=A(ge),B=E(ge,"OL",{class:!0});var he=L(B);for(let Ie=0;Ie<z.length;Ie+=1)z[Ie].l(he);he.forEach(d),ge.forEach(d),T=A(q),S=E(q,"DIV",{class:!0});var Re=L(S);V(D.$$.fragment,Re),Re.forEach(d),q.forEach(d),this.h()},h(){m(o,"class",Gt("codicon codicon-close")+" svelte-1x6vc81"),m(i,"for","supertag-name"),m(i,"class","svelte-1x6vc81"),m(p,"type","text"),m(p,"placeholder","Descriptive name"),m(p,"id","supertag-name"),m(p,"class","svelte-1x6vc81"),m(a,"class","svelte-1x6vc81"),m(g,"for","supertag-description"),m(g,"class","svelte-1x6vc81"),m($,"type","text"),m($,"placeholder","Short description"),m($,"id","supertag-description"),m($,"class","svelte-1x6vc81"),m(w,"class","svelte-1x6vc81"),m(P,"class","svelte-1x6vc81"),m(B,"class","svelte-1x6vc81"),m(h,"class","svelte-1x6vc81"),m(S,"class","last svelte-1x6vc81"),m(e,"class","svelte-1x6vc81")},m(H,q){O(H,e,q),_(e,n),_(e,s),_(e,o),_(e,r),_(e,a),_(a,i),_(a,u),_(a,p),Ye(p,l[0]),_(e,f),_(e,w),_(w,g),_(w,G),_(w,$),Ye($,l[2]),_(e,v),_(e,h),_(h,P),_(h,J),_(h,B);for(let ne=0;ne<z.length;ne+=1)z[ne]&&z[ne].m(B,null);_(e,T),_(e,S),F(D,S,null),j=!0,I||(ee=[ke(o,"click",l[6]),ke(p,"input",l[7]),ke($,"input",l[8])],I=!0)},p(H,q){if(q&1&&p.value!==H[0]&&Ye(p,H[0]),q&4&&$.value!==H[2]&&Ye($,H[2]),q&8){Q=Te(H[3]);let X;for(X=0;X<Q.length;X+=1){const ge=vt(H,Q,X);z[X]?(z[X].p(ge,q),b(z[X],1)):(z[X]=bt(ge),z[X].c(),b(z[X],1),z[X].m(B,null))}for(ce(),X=Q.length;X<z.length;X+=1)le(X);ue()}const ne={};q&16&&(ne.title=H[4]?"Click to create supertag":"Enter a valid name to continue"),q&16&&(ne.disabled=!H[4]),q&16384&&(ne.$$scope={dirty:q,ctx:H}),D.$set(ne)},i(H){if(!j){for(let q=0;q<Q.length;q+=1)b(z[q]);b(D.$$.fragment,H),j=!0}},o(H){z=z.filter(Boolean);for(let q=0;q<z.length;q+=1)k(z[q]);k(D.$$.fragment,H),j=!1},d(H){H&&d(e),xe(z,H),M(D),I=!1,ct(ee)}}}function Un(l){let e,n,t;function s(r){l[10](r)}let o={$$slots:{default:[Gn]},$$scope:{ctx:l}};return l[1]!==void 0&&(o.dialog=l[1]),e=new Ht({props:o}),we.push(()=>Fe(e,"dialog",s)),e.$on("close",l[6]),{c(){R(e.$$.fragment)},l(r){V(e.$$.fragment,r)},m(r,a){F(e,r,a),t=!0},p(r,[a]){const i={};a&16413&&(i.$$scope={dirty:a,ctx:r}),!n&&a&2&&(n=!0,i.dialog=r[1],Ve(()=>n=!1)),e.$set(i)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){M(e,r)}}}function Hn(l,e,n){let t,{dialog:s}=e,{name:o=""}=e,{description:r=""}=e,{tags:a}=e;const i=Le(),c=()=>s.close();function u(){o=this.value,n(0,o)}function p(){r=this.value,n(2,r)}const f=()=>{i("submit",{name:o,description:r,tags:a.map(({modifier:g,name:y})=>({modifier:g,name:y}))}),c()};function w(g){s=g,n(1,s)}return l.$$set=g=>{"dialog"in g&&n(1,s=g.dialog),"name"in g&&n(0,o=g.name),"description"in g&&n(2,r=g.description),"tags"in g&&n(3,a=g.tags)},l.$$.update=()=>{l.$$.dirty&9&&n(4,t=typeof o=="string"&&o!==""&&a.length>1)},[o,s,r,a,t,i,c,u,p,f,w]}class qn extends pe{constructor(e){super(),_e(this,e,Hn,Un,fe,{dialog:1,name:0,description:2,tags:3})}}function Kn(l){let e,n,t,s,o,r,a,i,c,u;return{c(){e=C("div"),n=C("div"),t=C("i"),s=N(),o=C("div"),r=C("h3"),a=oe(l[0]),i=N(),c=C("span"),u=oe(l[2]),this.h()},l(p){e=E(p,"DIV",{class:!0});var f=L(e);n=E(f,"DIV",{class:!0});var w=L(n);t=E(w,"I",{class:!0}),L(t).forEach(d),w.forEach(d),s=A(f),o=E(f,"DIV",{});var g=L(o);r=E(g,"H3",{class:!0});var y=L(r);a=ie(y,l[0]),y.forEach(d),i=A(g),c=E(g,"SPAN",{});var G=L(c);u=ie(G,l[2]),G.forEach(d),g.forEach(d),f.forEach(d),this.h()},h(){m(t,"class",Gt(l[1])+" svelte-1yohziu"),m(n,"class","icon svelte-1yohziu"),m(r,"class","svelte-1yohziu"),m(e,"class","error svelte-1yohziu")},m(p,f){O(p,e,f),_(e,n),_(n,t),_(e,s),_(e,o),_(o,r),_(r,a),_(o,i),_(o,c),_(c,u)},p:Y,i:Y,o:Y,d(p){p&&d(e)}}}function Wn(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",o=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",r=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&n(3,t=a.error)},[s,o,r,t]}class Jn extends pe{constructor(e){super(),_e(this,e,Wn,Kn,fe,{error:3})}}function Qn(l){let e,n,t,s,o="You have seen everything there is to see...";return{c(){e=C("img"),t=N(),s=C("p"),s.textContent=o,this.h()},l(r){e=E(r,"IMG",{src:!0,alt:!0,class:!0}),t=A(r),s=E(r,"P",{"data-svelte-h":!0}),re(s)!=="svelte-1i75mtf"&&(s.textContent=o),this.h()},h(){ye(e.src,n=Wt+"/assets/shironeko-x.png")||m(e,"src",n),m(e,"alt","No more results to load"),m(e,"class","svelte-1pkma0d")},m(r,a){O(r,e,a),O(r,t,a),O(r,s,a)},p:Y,i:Y,o:Y,d(r){r&&(d(e),d(t),d(s))}}}class Yn extends pe{constructor(e){super(),_e(this,e,null,Qn,fe,{})}}const rt=l=>`post_${l}`;function kt(l){let e;const n=l[4].default,t=an(n,l,l[3],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,o){t&&t.m(s,o),e=!0},p(s,o){t&&t.p&&(!e||o&8)&&cn(t,n,s,s[3],e?fn(n,s[3],o,null):un(s[3]),null)},i(s){e||(b(t,s),e=!0)},o(s){k(t,s),e=!1},d(s){t&&t.d(s)}}}function Zn(l){let e,n,t,s,o=l[1]&&kt(l);return{c(){e=C("div"),o&&o.c(),this.h()},l(r){e=E(r,"DIV",{role:!0,tabindex:!0,class:!0});var a=L(e);o&&o.l(a),a.forEach(d),this.h()},h(){m(e,"role","none"),m(e,"tabindex","-1"),m(e,"class","svelte-6sy8qz")},m(r,a){O(r,e,a),o&&o.m(e,null),l[5](e),n=!0,t||(s=[ke(e,"click",on(Xn)),ke(e,"keydown",l[2])],t=!0)},p(r,[a]){r[1]?o?(o.p(r,a),a&2&&b(o,1)):(o=kt(r),o.c(),b(o,1),o.m(e,null)):o&&(ce(),k(o,1,1,()=>{o=null}),ue())},i(r){n||(b(o),n=!0)},o(r){k(o),n=!1},d(r){r&&d(e),o&&o.d(),l[5](null),t=!1,ct(s)}}}const Xn=()=>{};function xn(l,e,n){let{$$slots:t={},$$scope:s}=e;const o=Le(),r=()=>o("close"),a=f=>{f.key==="Escape"&&r()},i=()=>{document.fullscreenElement||r()};let c,u=!1;ot(async()=>{c.focus(),document.addEventListener("fullscreenchange",i);try{await c.requestFullscreen()}catch{}n(1,u=!0)}),it(async()=>{document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});function p(f){we[f?"unshift":"push"](()=>{c=f,n(0,c)})}return l.$$set=f=>{"$$scope"in f&&n(3,s=f.$$scope)},[c,u,a,s,t,p]}class es extends pe{constructor(e){super(),_e(this,e,xn,Zn,fe,{})}}function ts(l){let e,n;return{c(){e=C("div"),this.h()},l(t){e=E(t,"DIV",{style:!0}),L(e).forEach(d),this.h()},h(){m(e,"style",n=l[0]?`position:absolute;top:${l[0]};`:void 0)},m(t,s){O(t,e,s),l[3](e)},p(t,[s]){s&1&&n!==(n=t[0]?`position:absolute;top:${t[0]};`:void 0)&&m(e,"style",n)},i:Y,o:Y,d(t){t&&d(e),l[3](null)}}}function ns(l,e,n){let{rootMargin:t}=e,{absoluteTop:s}=e;const o=Le(),r=new IntersectionObserver(c=>{c[0].isIntersecting&&o("intersection")},{rootMargin:t});let a;function i(c){we[c?"unshift":"push"](()=>{a=c,n(1,a)})}return l.$$set=c=>{"rootMargin"in c&&n(2,t=c.rootMargin),"absoluteTop"in c&&n(0,s=c.absoluteTop)},l.$$.update=()=>{l.$$.dirty&2&&(r.disconnect(),a&&r.observe(a))},[s,a,t,i]}class nn extends pe{constructor(e){super(),_e(this,e,ns,ts,fe,{rootMargin:2,absoluteTop:0})}}function wt(l,e,n){const t=l.slice();return t[5]=e[n],t}function yt(l,e,n){const t=l.slice();return t[8]=e[n][0],t[9]=e[n][1],t}function Ct(l){let e,n="•",t,s,o;return s=new Zt({props:{source:l[0].source}}),{c(){e=C("span"),e.textContent=n,t=N(),R(s.$$.fragment)},l(r){e=E(r,"SPAN",{"data-svelte-h":!0}),re(e)!=="svelte-7hh8jk"&&(e.textContent=n),t=A(r),V(s.$$.fragment,r)},m(r,a){O(r,e,a),O(r,t,a),F(s,r,a),o=!0},p(r,a){const i={};a&1&&(i.source=r[0].source),s.$set(i)},i(r){o||(b(s.$$.fragment,r),o=!0)},o(r){k(s.$$.fragment,r),o=!1},d(r){r&&(d(e),d(t)),M(s,r)}}}function Et(l){let e,n=l[8]+"",t,s,o,r;return o=new Xt({props:{tags:l[9]}}),{c(){e=C("h3"),t=oe(n),s=N(),R(o.$$.fragment),this.h()},l(a){e=E(a,"H3",{class:!0});var i=L(e);t=ie(i,n),i.forEach(d),s=A(a),V(o.$$.fragment,a),this.h()},h(){m(e,"class","svelte-1kekodt")},m(a,i){O(a,e,i),_(e,t),O(a,s,i),F(o,a,i),r=!0},p(a,i){(!r||i&2)&&n!==(n=a[8]+"")&&Oe(t,n);const c={};i&2&&(c.tags=a[9]),o.$set(c)},i(a){r||(b(o.$$.fragment,a),r=!0)},o(a){k(o.$$.fragment,a),r=!1},d(a){a&&(d(e),d(s)),M(o,a)}}}function ss(l){return{c:Y,l:Y,m:Y,p:Y,i:Y,o:Y,d:Y}}function ls(l){let e,n,t,s;const o=[os,rs],r=[];function a(i,c){return i[4].length>0?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=Ce()},l(i){n.l(i),t=Ce()},m(i,c){r[e].m(i,c),O(i,t,c),s=!0},p(i,c){let u=e;e=a(i),e===u?r[e].p(i,c):(ce(),k(r[u],1,1,()=>{r[u]=null}),ue(),n=r[e],n?n.p(i,c):(n=r[e]=o[e](i),n.c()),b(n,1),n.m(t.parentNode,t))},i(i){s||(b(n),s=!0)},o(i){k(n),s=!1},d(i){i&&d(t),r[e].d(i)}}}function rs(l){let e,n="Comments for this post are not available";return{c(){e=C("span"),e.textContent=n,this.h()},l(t){e=E(t,"SPAN",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-4t2lxe"&&(e.textContent=n),this.h()},h(){m(e,"class","no-comments svelte-1kekodt")},m(t,s){O(t,e,s)},p:Y,i:Y,o:Y,d(t){t&&d(e)}}}function os(l){let e,n,t=Te(l[4]),s=[];for(let r=0;r<t.length;r+=1)s[r]=St(wt(l,t,r));const o=r=>k(s[r],1,1,()=>{s[r]=null});return{c(){e=C("ul");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=E(r,"UL",{class:!0});var a=L(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(d),this.h()},h(){m(e,"class","comments svelte-1kekodt")},m(r,a){O(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&1){t=Te(r[4]);let i;for(i=0;i<t.length;i+=1){const c=wt(r,t,i);s[i]?(s[i].p(c,a),b(s[i],1)):(s[i]=St(c),s[i].c(),b(s[i],1),s[i].m(e,null))}for(ce(),i=t.length;i<s.length;i+=1)o(i);ue()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)b(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)k(s[a]);n=!1},d(r){r&&d(e),xe(s,r)}}}function St(l){let e,n;return e=new Cn({props:{comment:l[5]}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.comment=t[5]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function is(l){let e,n;return e=new pt({}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function as(l){let e,n,t,s,o,r,a,i,c=l[0].id+"",u,p,f,w,g,y,G="•",$,v,h=l[0].type.toUpperCase()+"",P,U,J,B="•",T,S,D,j,I="•",ee,Q,z,le,H,q,ne,X="•",ge,he,Re,Ie,et="•",tt,Pe,nt,qe,je,Ke,K,x,Ae="Comments",Ne,De,$e;w=new wn({props:{value:l[0].rating}}),S=new Jt({props:{value:l[0].score}}),Q=new Qt({props:{value:l[0].change}}),H=new Yt({props:{url:"/post?id="+l[0].id+"&src="+encodeURIComponent(l[3])}}),he=new Zt({props:{source:"https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id}}),Pe=new yn({props:{url:l[3]}});let te=l[0].source&&Ct(l),Ee=Te(Object.entries(l[1])),se=[];for(let Z=0;Z<Ee.length;Z+=1)se[Z]=Et(yt(l,Ee,Z));const rn=Z=>k(se[Z],1,1,()=>{se[Z]=null});let ve={ctx:l,current:null,token:null,hasCatch:!1,pending:is,then:ls,catch:ss,value:4,blocks:[,,,]};return dt(De=mt(l[0].id),ve),{c(){e=C("div"),n=C("img"),s=N(),o=C("h1"),r=oe("Post "),a=C("b"),i=oe("#"),u=oe(c),p=N(),f=C("div"),R(w.$$.fragment),g=N(),y=C("span"),y.textContent=G,$=N(),v=C("span"),P=oe(h),U=N(),J=C("span"),J.textContent=B,T=N(),R(S.$$.fragment),D=N(),j=C("span"),j.textContent=I,ee=N(),R(Q.$$.fragment),z=N(),le=C("div"),R(H.$$.fragment),q=N(),ne=C("span"),ne.textContent=X,ge=N(),R(he.$$.fragment),Re=N(),Ie=C("span"),Ie.textContent=et,tt=N(),R(Pe.$$.fragment),nt=N(),te&&te.c(),qe=N(),je=C("div");for(let Z=0;Z<se.length;Z+=1)se[Z].c();Ke=N(),K=C("div"),x=C("h3"),x.textContent=Ae,Ne=N(),ve.block.c(),this.h()},l(Z){e=E(Z,"DIV",{class:!0});var W=L(e);n=E(W,"IMG",{class:!0,src:!0,alt:!0}),s=A(W),o=E(W,"H1",{class:!0});var Se=L(o);r=ie(Se,"Post "),a=E(Se,"B",{});var We=L(a);i=ie(We,"#"),u=ie(We,c),We.forEach(d),Se.forEach(d),p=A(W),f=E(W,"DIV",{class:!0});var de=L(f);V(w.$$.fragment,de),g=A(de),y=E(de,"SPAN",{"data-svelte-h":!0}),re(y)!=="svelte-7hh8jk"&&(y.textContent=G),$=A(de),v=E(de,"SPAN",{});var st=L(v);P=ie(st,h),st.forEach(d),U=A(de),J=E(de,"SPAN",{"data-svelte-h":!0}),re(J)!=="svelte-7hh8jk"&&(J.textContent=B),T=A(de),V(S.$$.fragment,de),D=A(de),j=E(de,"SPAN",{"data-svelte-h":!0}),re(j)!=="svelte-7hh8jk"&&(j.textContent=I),ee=A(de),V(Q.$$.fragment,de),de.forEach(d),z=A(W),le=E(W,"DIV",{class:!0});var be=L(le);V(H.$$.fragment,be),q=A(be),ne=E(be,"SPAN",{"data-svelte-h":!0}),re(ne)!=="svelte-7hh8jk"&&(ne.textContent=X),ge=A(be),V(he.$$.fragment,be),Re=A(be),Ie=E(be,"SPAN",{"data-svelte-h":!0}),re(Ie)!=="svelte-7hh8jk"&&(Ie.textContent=et),tt=A(be),V(Pe.$$.fragment,be),nt=A(be),te&&te.l(be),be.forEach(d),qe=A(W),je=E(W,"DIV",{});var lt=L(je);for(let Je=0;Je<se.length;Je+=1)se[Je].l(lt);lt.forEach(d),Ke=A(W),K=E(W,"DIV",{});var ae=L(K);x=E(ae,"H3",{class:!0,"data-svelte-h":!0}),re(x)!=="svelte-kc6sae"&&(x.textContent=Ae),Ne=A(ae),ve.block.l(ae),ae.forEach(d),W.forEach(d),this.h()},h(){m(n,"class","preview svelte-1kekodt"),ye(n.src,t=l[2])||m(n,"src",t),m(n,"alt","preview"),m(o,"class","svelte-1kekodt"),m(f,"class","flex-row svelte-1kekodt"),m(le,"class","flex-row svelte-1kekodt"),m(x,"class","svelte-1kekodt"),m(e,"class","details svelte-1kekodt")},m(Z,W){O(Z,e,W),_(e,n),_(e,s),_(e,o),_(o,r),_(o,a),_(a,i),_(a,u),_(e,p),_(e,f),F(w,f,null),_(f,g),_(f,y),_(f,$),_(f,v),_(v,P),_(f,U),_(f,J),_(f,T),F(S,f,null),_(f,D),_(f,j),_(f,ee),F(Q,f,null),_(e,z),_(e,le),F(H,le,null),_(le,q),_(le,ne),_(le,ge),F(he,le,null),_(le,Re),_(le,Ie),_(le,tt),F(Pe,le,null),_(le,nt),te&&te.m(le,null),_(e,qe),_(e,je);for(let Se=0;Se<se.length;Se+=1)se[Se]&&se[Se].m(je,null);_(e,Ke),_(e,K),_(K,x),_(K,Ne),ve.block.m(K,ve.anchor=null),ve.mount=()=>K,ve.anchor=null,$e=!0},p(Z,[W]){l=Z,(!$e||W&4&&!ye(n.src,t=l[2]))&&m(n,"src",t),(!$e||W&1)&&c!==(c=l[0].id+"")&&Oe(u,c);const Se={};W&1&&(Se.value=l[0].rating),w.$set(Se),(!$e||W&1)&&h!==(h=l[0].type.toUpperCase()+"")&&Oe(P,h);const We={};W&1&&(We.value=l[0].score),S.$set(We);const de={};W&1&&(de.value=l[0].change),Q.$set(de);const st={};W&9&&(st.url="/post?id="+l[0].id+"&src="+encodeURIComponent(l[3])),H.$set(st);const be={};W&1&&(be.source="https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id),he.$set(be);const lt={};if(W&8&&(lt.url=l[3]),Pe.$set(lt),l[0].source?te?(te.p(l,W),W&1&&b(te,1)):(te=Ct(l),te.c(),b(te,1),te.m(le,null)):te&&(ce(),k(te,1,1,()=>{te=null}),ue()),W&2){Ee=Te(Object.entries(l[1]));let ae;for(ae=0;ae<Ee.length;ae+=1){const Je=yt(l,Ee,ae);se[ae]?(se[ae].p(Je,W),b(se[ae],1)):(se[ae]=Et(Je),se[ae].c(),b(se[ae],1),se[ae].m(je,null))}for(ce(),ae=Ee.length;ae<se.length;ae+=1)rn(ae);ue()}ve.ctx=l,W&1&&De!==(De=mt(l[0].id))&&dt(De,ve)||kn(ve,l,W)},i(Z){if(!$e){b(w.$$.fragment,Z),b(S.$$.fragment,Z),b(Q.$$.fragment,Z),b(H.$$.fragment,Z),b(he.$$.fragment,Z),b(Pe.$$.fragment,Z),b(te);for(let W=0;W<Ee.length;W+=1)b(se[W]);b(ve.block),$e=!0}},o(Z){k(w.$$.fragment,Z),k(S.$$.fragment,Z),k(Q.$$.fragment,Z),k(H.$$.fragment,Z),k(he.$$.fragment,Z),k(Pe.$$.fragment,Z),k(te),se=se.filter(Boolean);for(let W=0;W<se.length;W+=1)k(se[W]);for(let W=0;W<3;W+=1){const Se=ve.blocks[W];k(Se)}$e=!1},d(Z){Z&&d(e),M(w),M(S),M(Q),M(H),M(he),M(Pe),te&&te.d(),xe(se,Z),ve.block.d(),ve.token=null,ve=null}}}function cs(l,e,n){let t,s,o,{post:r}=e;return l.$$set=a=>{"post"in a&&n(0,r=a.post)},l.$$.update=()=>{l.$$.dirty&1&&n(3,t=r.file_url),l.$$.dirty&1&&n(2,s=r.sample_url),l.$$.dirty&1&&n(1,o=r.tags.reduce((a,i)=>(a[i.type]===void 0&&(a[i.type]=[]),a[i.type].push(i),a),{}))},[r,o,s,t]}class us extends pe{constructor(e){super(),_e(this,e,cs,as,fe,{post:0})}}const Qe=new IntersectionObserver(l=>{for(const e of l)if(e.target){const n=e.target;e.isIntersecting&&n.autoplay&&n.paused&&n.play(),!e.isIntersecting&&!n.paused&&n.pause()}},{rootMargin:"-1px",threshold:.001});function fs(l){const e=l.slice(),n=En(e[0].file_url,e[0].sample_url,e[0].preview_url);e[5]=n;const t=e[5].animated;return e[6]=t,e}function ps(l){const e=l.slice(),n=xt(e[0].file_url,e[0].sample_url,e[0].preview_url);e[5]=n;const t=e[5].animated;e[6]=t;const s=e[5].static;return e[7]=s,e}function _s(l){const e=l.slice(),n=e[0].sample_url;return e[4]=n,e}function ds(l){let e,n,t,s;return{c(){e=C("img"),this.h()},l(o){e=E(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ye(e.src,n=l[6])||m(e,"src",n),m(e,"alt",t="[GIF] post #"+l[0].id),m(e,"title",s="[GIF] post #"+l[0].id),m(e,"class","svelte-1cjgn2p")},m(o,r){O(o,e,r)},p(o,r){r&1&&!ye(e.src,n=o[6])&&m(e,"src",n),r&1&&t!==(t="[GIF] post #"+o[0].id)&&m(e,"alt",t),r&1&&s!==(s="[GIF] post #"+o[0].id)&&m(e,"title",s)},d(o){o&&d(e)}}}function It(l){let e,n,t,s;return{c(){e=C("video"),this.h()},l(o){e=E(o,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),L(e).forEach(d),this.h()},h(){ye(e.src,n=l[6])||m(e,"src",n),m(e,"poster",t=l[7]),e.loop=!0,m(e,"title",s="[VIDEO] post #"+l[0].id),e.controls=!0,m(e,"preload","metadata"),e.autoplay=!0,m(e,"class","svelte-1cjgn2p")},m(o,r){O(o,e,r),l[2](e)},p(o,r){r&1&&!ye(e.src,n=o[6])&&m(e,"src",n),r&1&&t!==(t=o[7])&&m(e,"poster",t),r&1&&s!==(s="[VIDEO] post #"+o[0].id)&&m(e,"title",s)},d(o){o&&d(e),l[2](null)}}}function Dt(l){let e,n,t,s;return{c(){e=C("img"),this.h()},l(o){e=E(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ye(e.src,n=l[4])||m(e,"src",n),m(e,"alt",t="[IMAGE] post #"+l[0].id),m(e,"title",s="[IMAGE] post #"+l[0].id),m(e,"class","svelte-1cjgn2p")},m(o,r){O(o,e,r)},p(o,r){r&1&&!ye(e.src,n=o[4])&&m(e,"src",n),r&1&&t!==(t="[IMAGE] post #"+o[0].id)&&m(e,"alt",t),r&1&&s!==(s="[IMAGE] post #"+o[0].id)&&m(e,"title",s)},d(o){o&&d(e)}}}function ms(l){let e;function n(r,a){return r[0].type==="image"?Dt:r[0].type==="video"?It:ds}function t(r,a){return a===Dt?_s(r):a===It?ps(r):fs(r)}let s=n(l),o=s(t(l,s));return{c(){o.c(),e=Ce()},l(r){o.l(r),e=Ce()},m(r,a){o.m(r,a),O(r,e,a)},p(r,[a]){s===(s=n(r))&&o?o.p(t(r,s),a):(o.d(1),o=s(t(r,s)),o&&(o.c(),o.m(e.parentNode,e)))},i:Y,o:Y,d(r){r&&d(e),o.d(r)}}}function gs(l,e,n){let{post:t}=e,s;const o=a=>{t.type==="video"&&s&&(a.key==="ArrowLeft"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.max(0,s.currentTime-5),s)),a.key==="ArrowRight"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.min(s.duration,s.currentTime+5),s)))};ot(()=>{s&&(Qe==null||Qe.observe(s)),document.addEventListener("keydown",o)}),it(()=>{s&&(Qe==null||Qe.unobserve(s)),document.removeEventListener("keydown",o)});function r(a){we[a?"unshift":"push"](()=>{s=a,n(1,s)})}return l.$$set=a=>{"post"in a&&n(0,t=a.post)},[t,s,r]}class hs extends pe{constructor(e){super(),_e(this,e,gs,ms,fe,{post:0})}}function $s(l){let e,n,t;return{c(){e=C("img"),this.h()},l(s){e=E(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ye(e.src,n=l[2])||m(e,"src",n),m(e,"alt",t="post #"+l[0].id),m(e,"class","svelte-itxz72"),ze(e,"top",l[1])},m(s,o){O(s,e,o)},p(s,[o]){o&4&&!ye(e.src,n=s[2])&&m(e,"src",n),o&1&&t!==(t="post #"+s[0].id)&&m(e,"alt",t),o&2&&ze(e,"top",s[1])},i:Y,o:Y,d(s){s&&d(e)}}}function vs(l,e,n){let t,{post:s}=e,{offset:o}=e;return l.$$set=r=>{"post"in r&&n(0,s=r.post),"offset"in r&&n(1,o=r.offset)},l.$$.update=()=>{l.$$.dirty&1&&n(2,t=Sn(s.sample_url)?s.preview_url:s.sample_url)},[s,o,t]}class sn extends pe{constructor(e){super(),_e(this,e,vs,$s,fe,{post:0,offset:1})}}function Tt(l,e,n){const t=l.slice();return t[16]=e[n],t[18]=n,t}function Pt(l){let e,n;return e=new sn({props:{post:l[3],offset:l[6]}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&8&&(o.post=t[3]),s&64&&(o.offset=t[6]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Nt(l){let e,n;return e=new sn({props:{post:l[4],offset:l[7]}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&16&&(o.post=t[4]),s&128&&(o.offset=t[7]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function At(l){let e,n=`${l[18]*100}vh`;return{c(){e=C("div"),this.h()},l(t){e=E(t,"DIV",{class:!0}),L(e).forEach(d),this.h()},h(){m(e,"class","pseudo snap-item svelte-3khu3"),ze(e,"top",n)},m(t,s){O(t,e,s)},p:Y,d(t){t&&d(e)}}}function bs(l){let e,n,t,s,o,r,a,i,c,u,p,f,w,g=l[3]&&Pt(l);s=new hs({props:{post:l[2]}}),r=new us({props:{post:l[2]}});let y=l[4]&&Nt(l),G=Te({length:l[8].posts.length}),$=[];for(let v=0;v<G.length;v+=1)$[v]=At(Tt(l,G,v));return u=new nn({props:{absoluteTop:l[8].posts.length*100+"vh",rootMargin:window.innerHeight*3+"px"}}),u.$on("intersection",l[13]),{c(){e=C("div"),g&&g.c(),n=N(),t=C("div"),R(s.$$.fragment),o=N(),R(r.$$.fragment),a=N(),y&&y.c(),i=N();for(let v=0;v<$.length;v+=1)$[v].c();c=N(),R(u.$$.fragment),this.h()},l(v){e=E(v,"DIV",{class:!0});var h=L(e);g&&g.l(h),n=A(h),t=E(h,"DIV",{class:!0});var P=L(t);V(s.$$.fragment,P),o=A(P),V(r.$$.fragment,P),P.forEach(d),a=A(h),y&&y.l(h),i=A(h);for(let U=0;U<$.length;U+=1)$[U].l(h);c=A(h),V(u.$$.fragment,h),h.forEach(d),this.h()},h(){m(t,"class","screen snap-container horizontal current svelte-3khu3"),ze(t,"top",l[5]),m(e,"class","root screen snap-container svelte-3khu3")},m(v,h){O(v,e,h),g&&g.m(e,null),_(e,n),_(e,t),F(s,t,null),_(t,o),F(r,t,null),l[12](t),_(e,a),y&&y.m(e,null),_(e,i);for(let P=0;P<$.length;P+=1)$[P]&&$[P].m(e,null);_(e,c),F(u,e,null),l[14](e),p=!0,f||(w=ke(e,"scroll",l[10]),f=!0)},p(v,[h]){v[3]?g?(g.p(v,h),h&8&&b(g,1)):(g=Pt(v),g.c(),b(g,1),g.m(e,n)):g&&(ce(),k(g,1,1,()=>{g=null}),ue());const P={};h&4&&(P.post=v[2]),s.$set(P);const U={};if(h&4&&(U.post=v[2]),r.$set(U),h&32&&ze(t,"top",v[5]),v[4]?y?(y.p(v,h),h&16&&b(y,1)):(y=Nt(v),y.c(),b(y,1),y.m(e,i)):y&&(ce(),k(y,1,1,()=>{y=null}),ue()),h&256){G=Te({length:v[8].posts.length});let B;for(B=0;B<G.length;B+=1){const T=Tt(v,G,B);$[B]?$[B].p(T,h):($[B]=At(T),$[B].c(),$[B].m(e,c))}for(;B<$.length;B+=1)$[B].d(1);$.length=G.length}const J={};h&256&&(J.absoluteTop=v[8].posts.length*100+"vh"),u.$set(J)},i(v){p||(b(g),b(s.$$.fragment,v),b(r.$$.fragment,v),b(y),b(u.$$.fragment,v),p=!0)},o(v){k(g),k(s.$$.fragment,v),k(r.$$.fragment,v),k(y),k(u.$$.fragment,v),p=!1},d(v){v&&d(e),g&&g.d(),M(s),M(r),l[12](null),y&&y.d(),xe($,v),M(u),l[14](null),f=!1,w()}}}function ks(l,e,n){let t;me(l,Ze,h=>n(8,t=h));let{index:s}=e,o,r,a=t.posts[s],i=s>0?t.posts[s-1]:void 0,c=s<t.posts.length-1?t.posts[s+1]:void 0,u=`${s*100}vh`,p=`${(s-1)*100}vh`,f=`${(s+1)*100}vh`;const w=Le(),g=h=>{requestAnimationFrame(()=>{const P=h.target,U=P.getBoundingClientRect().height,J=P.scrollTop/U,B=Math.round(J);B!=s&&(n(11,s=B),n(2,a=t.posts[s]),n(3,i=s>0?t.posts[s-1]:void 0),n(4,c=s<t.posts.length-1?t.posts[s+1]:void 0),n(5,u=`${s*100}vh`),n(6,p=`${(s-1)*100}vh`),n(7,f=`${(s+1)*100}vh`),r&&n(1,r.scrollLeft=0,r))})},y=h=>{h.key==="d"&&(h.preventDefault(),h.stopPropagation(),r.scrollLeft===0?r.scrollBy({left:o.clientWidth,top:0,behavior:"smooth"}):r.scrollBy({left:-o.clientWidth,top:0,behavior:"smooth"})),h.key==="ArrowUp"&&(h.preventDefault(),h.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s-1),behavior:"smooth"})),h.key==="ArrowDown"&&(h.preventDefault(),h.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s+1),behavior:"smooth"}))};ot(()=>{r&&(r.scrollIntoView(!0),n(1,r.scrollLeft=0,r)),document.addEventListener("keydown",y)}),it(()=>{document.removeEventListener("keydown",y)});function G(h){we[h?"unshift":"push"](()=>{r=h,n(1,r)})}const $=()=>{w("endreached")};function v(h){we[h?"unshift":"push"](()=>{o=h,n(0,o)})}return l.$$set=h=>{"index"in h&&n(11,s=h.index)},[o,r,a,i,c,u,p,f,t,w,g,s,G,$,v]}class ws extends pe{constructor(e){super(),_e(this,e,ks,bs,fe,{index:11})}}function ys(l){let e;return{c(){e=C("i"),this.h()},l(n){e=E(n,"I",{class:!0}),L(e).forEach(d),this.h()},h(){m(e,"class","codicon codicon-close")},m(n,t){O(n,e,t)},p:Y,d(n){n&&d(e)}}}function Cs(l){let e,n,t,s,o;function r(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new ws({props:a}),we.push(()=>Fe(e,"index",r)),e.$on("endreached",l[3]),s=new vn({props:{class:"button-close",$$slots:{default:[ys]},$$scope:{ctx:l}}}),s.$on("click",l[1]),{c(){R(e.$$.fragment),t=N(),R(s.$$.fragment)},l(i){V(e.$$.fragment,i),t=A(i),V(s.$$.fragment,i)},m(i,c){F(e,i,c),O(i,t,c),F(s,i,c),o=!0},p(i,c){const u={};!n&&c&1&&(n=!0,u.index=i[0],Ve(()=>n=!1)),e.$set(u);const p={};c&128&&(p.$$scope={dirty:c,ctx:i}),s.$set(p)},i(i){o||(b(e.$$.fragment,i),b(s.$$.fragment,i),o=!0)},o(i){k(e.$$.fragment,i),k(s.$$.fragment,i),o=!1},d(i){i&&d(t),M(e,i),M(s,i)}}}function Es(l){let e,n;return e=new es({props:{$$slots:{default:[Cs]},$$scope:{ctx:l}}}),e.$on("close",l[1]),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,[s]){const o={};s&129&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ss(l,e,n){let{index:t}=e;const s=Le(),o=()=>{s("close",t)},r=u=>{u.key==="f"&&(u.preventDefault(),u.stopPropagation(),o())},a=()=>{var u,p;(((u=history.state)==null?void 0:u.fullscreen)===void 0||((p=history.state)==null?void 0:p.fullscreen)===!1)&&o()};ot(()=>{window.addEventListener("popstate",a),document.addEventListener("keydown",r)}),it(()=>{window.removeEventListener("popstate",a),document.removeEventListener("keydown",r)});function i(u){t=u,n(0,t)}function c(u){Xe.call(this,l,u)}return l.$$set=u=>{"index"in u&&n(0,t=u.index)},[t,o,i,c]}class Is extends pe{constructor(e){super(),_e(this,e,Ss,Es,fe,{index:0})}}function Ot(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=C("span"),t=oe(n),this.h()},l(s){e=E(s,"SPAN",{class:!0});var o=L(e);t=ie(o,n),o.forEach(d),this.h()},h(){m(e,"class","type svelte-rfj0jo")},m(s,o){O(s,e,o),_(e,t)},p(s,o){o&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Oe(t,n)},d(s){s&&d(e)}}}function Ds(l){let e,n,t,s,o,r,a=Me(l[0].score)+"",i,c,u,p,f=l[0].type!=="image"&&Ot(l);return{c(){e=C("div"),n=C("img"),s=N(),f&&f.c(),o=N(),r=C("span"),i=oe(a),this.h()},l(w){e=E(w,"DIV",{id:!0,class:!0,style:!0});var g=L(e);n=E(g,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=A(g),f&&f.l(g),o=A(g),r=E(g,"SPAN",{class:!0});var y=L(r);i=ie(y,a),y.forEach(d),g.forEach(d),this.h()},h(){ye(n.src,t=l[1])||m(n,"src",t),m(n,"alt","post"),m(n,"class","post-media svelte-rfj0jo"),m(n,"tabindex","-1"),m(n,"loading","lazy"),m(r,"class","score svelte-rfj0jo"),m(e,"id",c=rt(l[0].id)),m(e,"class","post svelte-rfj0jo"),ze(e,"grid-row","span "+l[2]),Ge(e,"open",open)},m(w,g){O(w,e,g),_(e,n),_(e,s),f&&f.m(e,null),_(e,o),_(e,r),_(r,i),u||(p=[ke(e,"click",l[3]),ke(e,"keydown",l[4])],u=!0)},p(w,[g]){g&2&&!ye(n.src,t=w[1])&&m(n,"src",t),w[0].type!=="image"?f?f.p(w,g):(f=Ot(w),f.c(),f.m(e,o)):f&&(f.d(1),f=null),g&1&&a!==(a=Me(w[0].score)+"")&&Oe(i,a),g&1&&c!==(c=rt(w[0].id))&&m(e,"id",c),g&0&&Ge(e,"open",open)},i:Y,o:Y,d(w){w&&d(e),f&&f.d(),u=!1,ct(p)}}}let Rt=5;function Ts(l,e,n){let t,{post:s}=e,o=1/3,r=s.width/s.height,a=Math.max(Math.min(Math.round(Rt/r),Rt/o),2);console.log(a);const i=p=>p.endsWith(".jpg")||p.endsWith(".jpeg")||p.endsWith(".png")||p.endsWith(".webp");function c(p){Xe.call(this,l,p)}const u=p=>{var f;(en(p)||p.key==="f")&&((f=p.target)==null||f.click())};return l.$$set=p=>{"post"in p&&n(0,s=p.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=i(s.sample_url)?s.sample_url:s.preview_url)},[s,t,a,c,u]}class Ps extends pe{constructor(e){super(),_e(this,e,Ts,Ds,fe,{post:0})}}function Vt(l){let e,n=Me(l[0].comment_count)+"",t,s,o;return{c(){e=C("button"),t=oe(n),this.h()},l(r){e=E(r,"BUTTON",{class:!0});var a=L(e);t=ie(a,n),a.forEach(d),this.h()},h(){m(e,"class","codicon codicon-comment svelte-nhpj3u"),Ge(e,"active",l[1]==="comments")},m(r,a){O(r,e,a),_(e,t),s||(o=ke(e,"click",l[3]),s=!0)},p(r,a){a&1&&n!==(n=Me(r[0].comment_count)+"")&&Oe(t,n),a&2&&Ge(e,"active",r[1]==="comments")},d(r){r&&d(e),s=!1,o()}}}function Ns(l){let e,n,t,s,o="•",r,a,i,c,u="•",p,f,w,g,y,G,$,v=Me(l[0].tags.length)+"",h,P,U,J;n=new Qt({props:{value:l[0].change}}),a=new Jt({props:{value:l[0].score}}),f=new Yt({props:{url:"/post?id="+l[0].id+"&src="+encodeURIComponent(l[0].file_url)}});let B=l[0].comment_count&&Vt(l);return{c(){e=C("div"),R(n.$$.fragment),t=N(),s=C("span"),s.textContent=o,r=N(),R(a.$$.fragment),i=N(),c=C("span"),c.textContent=u,p=N(),R(f.$$.fragment),w=N(),g=C("span"),y=N(),B&&B.c(),G=N(),$=C("button"),h=oe(v),this.h()},l(T){e=E(T,"DIV",{class:!0});var S=L(e);V(n.$$.fragment,S),t=A(S),s=E(S,"SPAN",{"data-svelte-h":!0}),re(s)!=="svelte-7hh8jk"&&(s.textContent=o),r=A(S),V(a.$$.fragment,S),i=A(S),c=E(S,"SPAN",{"data-svelte-h":!0}),re(c)!=="svelte-7hh8jk"&&(c.textContent=u),p=A(S),V(f.$$.fragment,S),w=A(S),g=E(S,"SPAN",{class:!0}),L(g).forEach(d),y=A(S),B&&B.l(S),G=A(S),$=E(S,"BUTTON",{class:!0});var D=L($);h=ie(D,v),D.forEach(d),S.forEach(d),this.h()},h(){m(g,"class","divider svelte-nhpj3u"),m($,"class","codicon codicon-tag svelte-nhpj3u"),Ge($,"active",l[1]==="tags"),m(e,"class","summary svelte-nhpj3u")},m(T,S){O(T,e,S),F(n,e,null),_(e,t),_(e,s),_(e,r),F(a,e,null),_(e,i),_(e,c),_(e,p),F(f,e,null),_(e,w),_(e,g),_(e,y),B&&B.m(e,null),_(e,G),_(e,$),_($,h),P=!0,U||(J=ke($,"click",l[4]),U=!0)},p(T,[S]){const D={};S&1&&(D.value=T[0].change),n.$set(D);const j={};S&1&&(j.value=T[0].score),a.$set(j);const I={};S&1&&(I.url="/post?id="+T[0].id+"&src="+encodeURIComponent(T[0].file_url)),f.$set(I),T[0].comment_count?B?B.p(T,S):(B=Vt(T),B.c(),B.m(e,G)):B&&(B.d(1),B=null),(!P||S&1)&&v!==(v=Me(T[0].tags.length)+"")&&Oe(h,v),(!P||S&2)&&Ge($,"active",T[1]==="tags")},i(T){P||(b(n.$$.fragment,T),b(a.$$.fragment,T),b(f.$$.fragment,T),P=!0)},o(T){k(n.$$.fragment,T),k(a.$$.fragment,T),k(f.$$.fragment,T),P=!1},d(T){T&&d(e),M(n),M(a),M(f),B&&B.d(),U=!1,J()}}}function As(l,e,n){const t=Le();let{post:s}=e,{active:o}=e;const r=()=>t("comments"),a=()=>t("tags");return l.$$set=i=>{"post"in i&&n(0,s=i.post),"active"in i&&n(1,o=i.active)},[s,o,t,r,a]}class Os extends pe{constructor(e){super(),_e(this,e,As,Ns,fe,{post:0,active:1})}}function Rs(l){let e,n='<i class="codicon codicon-screen-full"></i>',t,s;return{c(){e=C("button"),e.innerHTML=n,this.h()},l(o){e=E(o,"BUTTON",{type:!0,title:!0,class:!0,"data-svelte-h":!0}),re(e)!=="svelte-hnv5zq"&&(e.innerHTML=n),this.h()},h(){m(e,"type","button"),m(e,"title","Enter Fullscreen mode"),m(e,"class","svelte-txn4jo")},m(o,r){O(o,e,r),t||(s=ke(e,"click",l[0]),t=!0)},p:Y,i:Y,o:Y,d(o){o&&d(e),t=!1,s()}}}function Vs(l){function e(n){Xe.call(this,l,n)}return[e]}class Fs extends pe{constructor(e){super(),_e(this,e,Vs,Rs,fe,{})}}function Ms(l){const e=l.slice(),n=xt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[9]=n,e}function Ls(l){let e,n;return e=new In({props:{post:l[1]}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function js(l){let e,n;return e=new Dn({props:{src:l[9].animated,poster:l[9].static,width:l[1].width,height:l[1].height,loop:l[2]||gt(l[1].tags)}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.src=t[9].animated),s&2&&(o.poster=t[9].static),s&2&&(o.width=t[1].width),s&2&&(o.height=t[1].height),s&6&&(o.loop=t[2]||gt(t[1].tags)),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Bs(l){let e,n;return e=new Tn({props:{post:l[1]}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function zs(l){let e,n;return e=new Pn({props:{post:l[1]}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Gs(l){let e,n;return e=new Xt({props:{tags:l[1].tags}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.tags=t[1].tags),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Us(l){let e,n,t,s,o,r,a,i,c,u,p,f,w,g,y,G;const $=[Bs,js,Ls],v=[];function h(T,S){return T[1].type==="image"?0:T[1].type==="video"?1:2}function P(T,S){return S===1?Ms(T):T}t=h(l),s=v[t]=$[t](P(l,t)),r=new Fs({}),r.$on("click",l[5]),c=new Os({props:{active:l[0],post:l[1]}}),c.$on("tags",l[6]),c.$on("comments",l[7]);const U=[Gs,zs],J=[];function B(T,S){return T[0]==="tags"?0:T[0]==="comments"?1:-1}return~(p=B(l))&&(f=J[p]=U[p](l)),{c(){e=C("div"),n=C("div"),s.c(),o=N(),R(r.$$.fragment),a=N(),i=C("div"),R(c.$$.fragment),u=N(),f&&f.c(),this.h()},l(T){e=E(T,"DIV",{id:!0,class:!0});var S=L(e);n=E(S,"DIV",{});var D=L(n);s.l(D),D.forEach(d),o=A(S),V(r.$$.fragment,S),a=A(S),i=E(S,"DIV",{class:!0});var j=L(i);V(c.$$.fragment,j),u=A(j),f&&f.l(j),j.forEach(d),S.forEach(d),this.h()},h(){m(i,"class","details svelte-h1zvr"),m(e,"id",w=rt(l[1].id)),m(e,"class","post svelte-h1zvr"),Ge(e,"openTab",l[0])},m(T,S){O(T,e,S),_(e,n),v[t].m(n,null),_(e,o),F(r,e,null),_(e,a),_(e,i),F(c,i,null),_(i,u),~p&&J[p].m(i,null),g=!0,y||(G=ke(e,"keydown",l[8]),y=!0)},p(T,[S]){let D=t;t=h(T),t===D?v[t].p(P(T,t),S):(ce(),k(v[D],1,1,()=>{v[D]=null}),ue(),s=v[t],s?s.p(P(T,t),S):(s=v[t]=$[t](P(T,t)),s.c()),b(s,1),s.m(n,null));const j={};S&1&&(j.active=T[0]),S&2&&(j.post=T[1]),c.$set(j);let I=p;p=B(T),p===I?~p&&J[p].p(T,S):(f&&(ce(),k(J[I],1,1,()=>{J[I]=null}),ue()),~p?(f=J[p],f?f.p(T,S):(f=J[p]=U[p](T),f.c()),b(f,1),f.m(i,null)):f=null),(!g||S&2&&w!==(w=rt(T[1].id)))&&m(e,"id",w),(!g||S&1)&&Ge(e,"openTab",T[0])},i(T){g||(b(s),b(r.$$.fragment,T),b(c.$$.fragment,T),b(f),g=!0)},o(T){k(s),k(r.$$.fragment,T),k(c.$$.fragment,T),k(f),g=!1},d(T){T&&d(e),v[t].d(),M(r),M(c),~p&&J[p].d(),y=!1,G()}}}function Hs(l,e,n){let t;me(l,Nn,f=>n(2,t=f));const s=Le();let{post:o}=e,{openTab:r=void 0}=e;const a=f=>{r===f?n(0,r=void 0):n(0,r=f)},i=()=>s("fullscreen"),c=()=>a("tags"),u=()=>a("comments"),p=f=>{f.key==="f"&&s("fullscreen")};return l.$$set=f=>{"post"in f&&n(1,o=f.post),"openTab"in f&&n(0,r=f.openTab)},[r,o,t,s,a,i,c,u,p]}class qs extends pe{constructor(e){super(),_e(this,e,Hs,Us,fe,{post:1,openTab:0})}}function Ks(l){let e;return{c(){e=oe("Done")},l(n){e=ie(n,"Done")},m(n,t){O(n,e,t)},d(n){n&&d(e)}}}function Ws(l){let e;return{c(){e=oe("Reset")},l(n){e=ie(n,"Reset")},m(n,t){O(n,e,t)},d(n){n&&d(e)}}}function Js(l){let e,n,t="Sorting and Filtering",s,o,r,a="Sorting",i,c,u,p,f,w,g,y,G,$,v="Filtering by Score",h,P,U,J,B,T,S,D,j,I="Filtering by Rating",ee,Q,z,le,H,q,ne,X,ge,he,Re;function Ie(K){l[6](K)}let et={options:Zs};l[3].direction!==void 0&&(et.value=l[3].direction),u=new bn({props:et}),we.push(()=>Fe(u,"value",Ie));function tt(K){l[7](K)}let Pe={options:Ys};l[3].property!==void 0&&(Pe.value=l[3].property),w=new ht({props:Pe}),we.push(()=>Fe(w,"value",tt));function nt(K){l[8](K)}let qe={options:Xs};l[2].scoreComparator!==void 0&&(qe.value=l[2].scoreComparator),U=new On({props:qe}),we.push(()=>Fe(U,"value",nt));function je(K){l[10](K)}let Ke={options:ln};return l[2].rating!==void 0&&(Ke.value=l[2].rating),z=new ht({props:Ke}),we.push(()=>Fe(z,"value",je)),q=new He({props:{title:"Return to searching.",$$slots:{default:[Ks]},$$scope:{ctx:l}}}),q.$on("click",l[11]),X=new He({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Ws]},$$scope:{ctx:l}}}),X.$on("click",l[5]),{c(){e=C("div"),n=C("h3"),n.textContent=t,s=N(),o=C("div"),r=C("b"),r.textContent=a,i=N(),c=C("div"),R(u.$$.fragment),f=N(),R(w.$$.fragment),y=N(),G=C("div"),$=C("b"),$.textContent=v,h=N(),P=C("div"),R(U.$$.fragment),B=N(),T=C("input"),S=N(),D=C("div"),j=C("b"),j.textContent=I,ee=N(),Q=C("div"),R(z.$$.fragment),H=N(),R(q.$$.fragment),ne=N(),R(X.$$.fragment),this.h()},l(K){e=E(K,"DIV",{class:!0});var x=L(e);n=E(x,"H3",{"data-svelte-h":!0}),re(n)!=="svelte-15zouq3"&&(n.textContent=t),s=A(x),o=E(x,"DIV",{});var Ae=L(o);r=E(Ae,"B",{class:!0,"data-svelte-h":!0}),re(r)!=="svelte-ekzpgg"&&(r.textContent=a),i=A(Ae),c=E(Ae,"DIV",{class:!0});var Ne=L(c);V(u.$$.fragment,Ne),f=A(Ne),V(w.$$.fragment,Ne),Ne.forEach(d),Ae.forEach(d),y=A(x),G=E(x,"DIV",{});var De=L(G);$=E(De,"B",{class:!0,"data-svelte-h":!0}),re($)!=="svelte-1flca3"&&($.textContent=v),h=A(De),P=E(De,"DIV",{class:!0});var $e=L(P);V(U.$$.fragment,$e),B=A($e),T=E($e,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),$e.forEach(d),De.forEach(d),S=A(x),D=E(x,"DIV",{});var te=L(D);j=E(te,"B",{class:!0,"data-svelte-h":!0}),re(j)!=="svelte-1evbw58"&&(j.textContent=I),ee=A(te),Q=E(te,"DIV",{class:!0});var Ee=L(Q);V(z.$$.fragment,Ee),Ee.forEach(d),te.forEach(d),H=A(x),V(q.$$.fragment,x),ne=A(x),V(X.$$.fragment,x),x.forEach(d),this.h()},h(){m(r,"class","svelte-kdg2ou"),m(c,"class","row svelte-kdg2ou"),m($,"class","svelte-kdg2ou"),m(T,"type","number"),m(T,"min",0),m(T,"max",1e5),m(T,"step",1),m(T,"class","svelte-kdg2ou"),m(P,"class","row svelte-kdg2ou"),m(j,"class","svelte-kdg2ou"),m(Q,"class","row svelte-kdg2ou"),m(e,"class","container svelte-kdg2ou")},m(K,x){O(K,e,x),_(e,n),_(e,s),_(e,o),_(o,r),_(o,i),_(o,c),F(u,c,null),_(c,f),F(w,c,null),_(e,y),_(e,G),_(G,$),_(G,h),_(G,P),F(U,P,null),_(P,B),_(P,T),Ye(T,l[1]),_(e,S),_(e,D),_(D,j),_(D,ee),_(D,Q),F(z,Q,null),_(e,H),F(q,e,null),_(e,ne),F(X,e,null),ge=!0,he||(Re=[ke(T,"input",l[9]),ke(T,"keyup",l[4])],he=!0)},p(K,x){const Ae={};!p&&x&8&&(p=!0,Ae.value=K[3].direction,Ve(()=>p=!1)),u.$set(Ae);const Ne={};!g&&x&8&&(g=!0,Ne.value=K[3].property,Ve(()=>g=!1)),w.$set(Ne);const De={};!J&&x&4&&(J=!0,De.value=K[2].scoreComparator,Ve(()=>J=!1)),U.$set(De),x&2&&Ut(T.value)!==K[1]&&Ye(T,K[1]);const $e={};!le&&x&4&&(le=!0,$e.value=K[2].rating,Ve(()=>le=!1)),z.$set($e);const te={};x&16384&&(te.$$scope={dirty:x,ctx:K}),q.$set(te);const Ee={};x&16384&&(Ee.$$scope={dirty:x,ctx:K}),X.$set(Ee)},i(K){ge||(b(u.$$.fragment,K),b(w.$$.fragment,K),b(U.$$.fragment,K),b(z.$$.fragment,K),b(q.$$.fragment,K),b(X.$$.fragment,K),ge=!0)},o(K){k(u.$$.fragment,K),k(w.$$.fragment,K),k(U.$$.fragment,K),k(z.$$.fragment,K),k(q.$$.fragment,K),k(X.$$.fragment,K),ge=!1},d(K){K&&d(e),M(u),M(w),M(U),M(z),M(q),M(X),he=!1,ct(Re)}}}function Qs(l){let e,n,t;function s(r){l[12](r)}let o={$$slots:{default:[Js]},$$scope:{ctx:l}};return l[0]!==void 0&&(o.dialog=l[0]),e=new Ht({props:o}),we.push(()=>Fe(e,"dialog",s)),e.$on("close",l[13]),{c(){R(e.$$.fragment)},l(r){V(e.$$.fragment,r)},m(r,a){F(e,r,a),t=!0},p(r,[a]){const i={};a&16399&&(i.$$scope={dirty:a,ctx:r}),!n&&a&1&&(n=!0,i.dialog=r[0],Ve(()=>n=!1)),e.$set(i)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){M(e,r)}}}const ln=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Ys=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),Zs=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Xs=Object.freeze({">=":"≥","<=":"≤"});function xs(l,e,n){let t,s;me(l,Be,$=>n(2,t=$)),me(l,Ue,$=>n(3,s=$));let{dialog:o}=e,r;const a=$=>{var v;return en($)&&((v=$.target)==null?void 0:v.blur())},i=()=>{Ue.reset(),Be.reset(),n(1,r=t.scoreValue)};function c($){l.$$.not_equal(s.direction,$)&&(s.direction=$,Ue.set(s))}function u($){l.$$.not_equal(s.property,$)&&(s.property=$,Ue.set(s))}function p($){l.$$.not_equal(t.scoreComparator,$)&&(t.scoreComparator=$,Be.set(t))}function f(){r=Ut(this.value),n(1,r),n(2,t)}function w($){l.$$.not_equal(t.rating,$)&&(t.rating=$,Be.set(t))}const g=()=>o.close();function y($){o=$,n(0,o)}function G($){Xe.call(this,l,$)}return l.$$set=$=>{"dialog"in $&&n(0,o=$.dialog)},l.$$.update=()=>{if(l.$$.dirty&6){r===void 0&&n(1,r=t.scoreValue);let $=Number(r);isNaN($)||pn(Be,t.scoreValue=$,t)}},[o,r,t,s,a,i,c,u,p,f,w,g,y,G]}class el extends pe{constructor(e){super(),_e(this,e,xs,Qs,fe,{dialog:0})}}function tl(l){let e,n,t,s,o,r,a,i,c,u,p,f,w,g,y,G;function $(h){l[9](h)}let v={};return l[2]!==void 0&&(v.dialog=l[2]),f=new el({props:v}),we.push(()=>Fe(f,"dialog",$)),f.$on("close",l[10]),{c(){e=C("button"),n=C("i"),t=N(),s=C("span"),o=oe(l[5]),r=N(),a=C("i"),i=N(),c=C("span"),u=oe(l[4]),p=N(),R(f.$$.fragment),this.h()},l(h){e=E(h,"BUTTON",{class:!0});var P=L(e);n=E(P,"I",{class:!0}),L(n).forEach(d),t=A(P),s=E(P,"SPAN",{});var U=L(s);o=ie(U,l[5]),U.forEach(d),r=A(P),a=E(P,"I",{class:!0}),L(a).forEach(d),i=A(P),c=E(P,"SPAN",{});var J=L(c);u=ie(J,l[4]),J.forEach(d),P.forEach(d),p=A(h),V(f.$$.fragment,h),this.h()},h(){m(n,"class","codicon codicon-filter svelte-a4zz3f"),m(a,"class","codicon codicon-arrow-swap svelte-a4zz3f"),m(e,"class","svelte-a4zz3f")},m(h,P){O(h,e,P),_(e,n),_(e,t),_(e,s),_(s,o),_(e,r),_(e,a),_(e,i),_(e,c),_(c,u),O(h,p,P),F(f,h,P),g=!0,y||(G=ke(e,"click",l[8]),y=!0)},p(h,[P]){(!g||P&32)&&Oe(o,h[5]),(!g||P&16)&&Oe(u,h[4]);const U={};!w&&P&4&&(w=!0,U.dialog=h[2],Ve(()=>w=!1)),f.$set(U)},i(h){g||(b(f.$$.fragment,h),g=!0)},o(h){k(f.$$.fragment,h),g=!1},d(h){h&&(d(e),d(p)),M(f,h),y=!1,G()}}}const nl=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),sl=(l,e,n)=>{let t=l==="all"?void 0:ln[l],s=e===0&&n===">="?void 0:`Score${n}${Me(e)}`;return[t,s].filter(o=>o!==void 0).join(",")||"All"};function ll(l,e,n){let t,s,o,r;me(l,Ue,g=>n(0,o=g)),me(l,Be,g=>n(1,r=g));const a=Le(),i=(g,y)=>JSON.stringify(Object.assign({},g,y));let c,u="";const p=()=>{n(3,u=i(o,r)),c.showModal(),qt("dialog")};function f(g){c=g,n(2,c)}const w=()=>{i(o,r)!==u&&a("sortfilterupdate")};return l.$$.update=()=>{l.$$.dirty&2&&n(5,t=sl(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&1&&n(4,s=nl[o.property][o.direction])},[o,r,c,u,s,t,a,i,p,f,w]}class rl extends pe{constructor(e){super(),_e(this,e,ll,tl,fe,{})}}function Ft(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Mt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function ol(l){let e,n,t=Te(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Lt(Ft(l,t,r));const o=r=>k(s[r],1,1,()=>{s[r]=null});return{c(){e=C("ol");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=E(r,"OL",{class:!0,style:!0});var a=L(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(d),this.h()},h(){m(e,"class","multi-column svelte-1sp0f1c"),ze(e,"--nr-columns",l[2])},m(r,a){O(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=Te(r[1].posts);let i;for(i=0;i<t.length;i+=1){const c=Ft(r,t,i);s[i]?(s[i].p(c,a),b(s[i],1)):(s[i]=Lt(c),s[i].c(),b(s[i],1),s[i].m(e,null))}for(ce(),i=t.length;i<s.length;i+=1)o(i);ue()}(!n||a&4)&&ze(e,"--nr-columns",r[2])},i(r){if(!n){for(let a=0;a<t.length;a+=1)b(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)k(s[a]);n=!1},d(r){r&&d(e),xe(s,r)}}}function il(l){let e,n,t=Te(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=jt(Mt(l,t,r));const o=r=>k(s[r],1,1,()=>{s[r]=null});return{c(){e=C("ol");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=E(r,"OL",{class:!0});var a=L(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(d),this.h()},h(){m(e,"class","single-column svelte-1sp0f1c")},m(r,a){O(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=Te(r[1].posts);let i;for(i=0;i<t.length;i+=1){const c=Mt(r,t,i);s[i]?(s[i].p(c,a),b(s[i],1)):(s[i]=jt(c),s[i].c(),b(s[i],1),s[i].m(e,null))}for(ce(),i=t.length;i<s.length;i+=1)o(i);ue()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)b(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)k(s[a]);n=!1},d(r){r&&d(e),xe(s,r)}}}function Lt(l){let e,n;function t(){return l[6](l[10])}return e=new Ps({props:{post:l[8]}}),e.$on("click",t),{c(){R(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,o){F(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function jt(l){let e,n;function t(){return l[5](l[10])}return e=new qs({props:{post:l[8]}}),e.$on("fullscreen",t),{c(){R(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,o){F(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function Bt(l){let e,n;return e=new Is({props:{index:l[0]}}),e.$on("close",l[3]),e.$on("endreached",l[7]),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.index=t[0]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function al(l){let e,n,t=Me(l[1].postCount)+"",s,o,r,a,i,c,u,p,f,w;a=new rl({}),a.$on("sortfilterupdate",l[4]);const g=[il,ol],y=[];function G(v,h){return v[2]==="1"?0:1}c=G(l),u=y[c]=g[c](l);let $=l[0]!==void 0&&Bt(l);return{c(){e=C("div"),n=C("span"),s=oe(t),o=oe(" posts"),r=N(),R(a.$$.fragment),i=N(),u.c(),p=N(),$&&$.c(),f=Ce(),this.h()},l(v){e=E(v,"DIV",{class:!0});var h=L(e);n=E(h,"SPAN",{});var P=L(n);s=ie(P,t),o=ie(P," posts"),P.forEach(d),r=A(h),V(a.$$.fragment,h),h.forEach(d),i=A(v),u.l(v),p=A(v),$&&$.l(v),f=Ce(),this.h()},h(){m(e,"class","svelte-1sp0f1c")},m(v,h){O(v,e,h),_(e,n),_(n,s),_(n,o),_(e,r),F(a,e,null),O(v,i,h),y[c].m(v,h),O(v,p,h),$&&$.m(v,h),O(v,f,h),w=!0},p(v,[h]){(!w||h&2)&&t!==(t=Me(v[1].postCount)+"")&&Oe(s,t);let P=c;c=G(v),c===P?y[c].p(v,h):(ce(),k(y[P],1,1,()=>{y[P]=null}),ue(),u=y[c],u?u.p(v,h):(u=y[c]=g[c](v),u.c()),b(u,1),u.m(p.parentNode,p)),v[0]!==void 0?$?($.p(v,h),h&1&&b($,1)):($=Bt(v),$.c(),b($,1),$.m(f.parentNode,f)):$&&(ce(),k($,1,1,()=>{$=null}),ue())},i(v){w||(b(a.$$.fragment,v),b(u),b($),w=!0)},o(v){k(a.$$.fragment,v),k(u),k($),w=!1},d(v){v&&(d(e),d(i),d(p),d(f)),M(a),y[c].d(v),$&&$.d(v)}}}function cl(l,e,n){let t,s;me(l,Ze,p=>n(1,t=p)),me(l,Kt,p=>n(2,s=p));let o;const r=p=>{var g;const f=t.posts[p.detail],w=rt(f.id);(g=document.getElementById(w))==null||g.scrollIntoView(),n(0,o=void 0)};function a(p){Xe.call(this,l,p)}const i=p=>{n(0,o=p)},c=p=>{n(0,o=p)};function u(p){Xe.call(this,l,p)}return l.$$.update=()=>{var p;l.$$.dirty&1&&(o!==void 0?history.pushState({...history.state,fullscreen:!0},""):(p=history.state)!=null&&p.fullscreen&&history.back())},[o,t,s,r,a,i,c,u]}class ul extends pe{constructor(e){super(),_e(this,e,cl,al,fe,{})}}function fl(l){let e;return{c(){e=oe("Reset Filter")},l(n){e=ie(n,"Reset Filter")},m(n,t){O(n,e,t)},d(n){n&&d(e)}}}function pl(l){let e,n,t,s,o="We couldn't find any posts matching your tags. Sorry...",r,a,i;return a=new He({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[fl]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=C("img"),t=N(),s=C("p"),s.textContent=o,r=N(),R(a.$$.fragment),this.h()},l(c){e=E(c,"IMG",{src:!0,alt:!0,class:!0}),t=A(c),s=E(c,"P",{"data-svelte-h":!0}),re(s)!=="svelte-1utxj3w"&&(s.textContent=o),r=A(c),V(a.$$.fragment,c),this.h()},h(){ye(e.src,n=Wt+"/assets/shironeko-confused.png")||m(e,"src",n),m(e,"alt","Nothing here..."),m(e,"class","svelte-1bb5e7g")},m(c,u){O(c,e,u),O(c,t,u),O(c,s,u),O(c,r,u),F(a,c,u),i=!0},p(c,[u]){const p={};u&4&&(p.$$scope={dirty:u,ctx:c}),a.$set(p)},i(c){i||(b(a.$$.fragment,c),i=!0)},o(c){k(a.$$.fragment,c),i=!1},d(c){c&&(d(e),d(t),d(s),d(r)),M(a,c)}}}function _l(l){const e=Le();return[e,()=>{Ue.reset(),Be.reset(),e("sortfilterupdate")}]}class dl extends pe{constructor(e){super(),_e(this,e,_l,pl,fe,{})}}function ml(l){const e=l-1;return e*e*e+1}function gl(l,{delay:e=0,duration:n=400,easing:t=ml,x:s=0,y:o=0,opacity:r=0}={}){const a=getComputedStyle(l),i=+a.opacity,c=a.transform==="none"?"":a.transform,u=i*(1-r),[p,f]=_t(s),[w,g]=_t(o);return{delay:e,duration:n,easing:t,css:(y,G)=>`
			transform: ${c} translate(${(1-y)*p}${f}, ${(1-y)*w}${g});
			opacity: ${i-u*G}`}}function hl(l){let e;return{c(){e=oe("Ok")},l(n){e=ie(n,"Ok")},m(n,t){O(n,e,t)},d(n){n&&d(e)}}}function $l(l){let e,n,t="This site uses cookies",s,o,r,a;return o=new He({props:{title:"Accept cookies",$$slots:{default:[hl]},$$scope:{ctx:l}}}),o.$on("click",l[0]),{c(){e=C("div"),n=C("span"),n.textContent=t,s=N(),R(o.$$.fragment),this.h()},l(i){e=E(i,"DIV",{class:!0});var c=L(e);n=E(c,"SPAN",{"data-svelte-h":!0}),re(n)!=="svelte-17tpe0c"&&(n.textContent=t),s=A(c),V(o.$$.fragment,c),c.forEach(d),this.h()},h(){m(e,"class","svelte-20j44m")},m(i,c){O(i,e,c),_(e,n),_(e,s),F(o,e,null),a=!0},p(i,[c]){const u={};c&2&&(u.$$scope={dirty:c,ctx:i}),o.$set(u)},i(i){a||(b(o.$$.fragment,i),r&&r.end(1),a=!0)},o(i){k(o.$$.fragment,i),i&&(r=dn(e,gl,{y:200,duration:200})),a=!1},d(i){i&&d(e),M(o),i&&r&&r.end()}}}function vl(l){return[()=>tn.set(!0)]}class bl extends pe{constructor(e){super(),_e(this,e,vl,$l,fe,{})}}const{document:ft}=mn;function kl(l){let e;return{c(){e=oe("Search")},l(n){e=ie(n,"Search")},m(n,t){O(n,e,t)},i:Y,o:Y,d(n){n&&d(e)}}}function wl(l){let e,n;return e=new pt({}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function yl(l){let e,n,t,s;const o=[wl,kl],r=[];function a(i,c){return i[0]?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=Ce()},l(i){n.l(i),t=Ce()},m(i,c){r[e].m(i,c),O(i,t,c),s=!0},p(i,c){let u=e;e=a(i),e!==u&&(ce(),k(r[u],1,1,()=>{r[u]=null}),ue(),n=r[e],n||(n=r[e]=o[e](i),n.c()),b(n,1),n.m(t.parentNode,t))},i(i){s||(b(n),s=!0)},o(i){k(n),s=!1},d(i){i&&d(t),r[e].d(i)}}}function Cl(l){let e,n,t,s,o,r;const a=[Il,Sl],i=[];function c(u,p){return u[3].postCount===0?0:1}return n=c(l),t=i[n]=a[n](l),o=new Vn({}),{c(){e=C("section"),t.c(),s=N(),R(o.$$.fragment),this.h()},l(u){e=E(u,"SECTION",{class:!0});var p=L(e);t.l(p),p.forEach(d),s=A(u),V(o.$$.fragment,u),this.h()},h(){m(e,"class","svelte-nujk24")},m(u,p){O(u,e,p),i[n].m(e,null),O(u,s,p),F(o,u,p),r=!0},p(u,p){let f=n;n=c(u),n===f?i[n].p(u,p):(ce(),k(i[f],1,1,()=>{i[f]=null}),ue(),t=i[n],t?t.p(u,p):(t=i[n]=a[n](u),t.c()),b(t,1),t.m(e,null))},i(u){r||(b(t),b(o.$$.fragment,u),r=!0)},o(u){k(t),k(o.$$.fragment,u),r=!1},d(u){u&&(d(e),d(s)),i[n].d(),M(o,u)}}}function El(l){let e,n;return e=new Jn({props:{error:l[1]}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.error=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Sl(l){let e,n,t,s,o,r;e=new ul({}),e.$on("sortfilterupdate",l[10]),e.$on("endreached",l[11]);const a=[Tl,Dl],i=[];function c(u,p){return u[3].posts.length===u[3].postCount?0:1}return t=c(l),s=i[t]=a[t](l),{c(){R(e.$$.fragment),n=N(),s.c(),o=Ce()},l(u){V(e.$$.fragment,u),n=A(u),s.l(u),o=Ce()},m(u,p){F(e,u,p),O(u,n,p),i[t].m(u,p),O(u,o,p),r=!0},p(u,p){let f=t;t=c(u),t===f?i[t].p(u,p):(ce(),k(i[f],1,1,()=>{i[f]=null}),ue(),s=i[t],s?s.p(u,p):(s=i[t]=a[t](u),s.c()),b(s,1),s.m(o.parentNode,o))},i(u){r||(b(e.$$.fragment,u),b(s),r=!0)},o(u){k(e.$$.fragment,u),k(s),r=!1},d(u){u&&(d(n),d(o)),M(e,u),i[t].d(u)}}}function Il(l){let e,n;return e=new dl({}),e.$on("sortfilterupdate",l[10]),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Dl(l){let e,n,t,s;return e=new nn({props:{absoluteTop:void 0,rootMargin:1e3/Number(l[7])+"px"}}),e.$on("intersection",l[11]),t=new He({props:{title:"Load more posts",$$slots:{default:[Al]},$$scope:{ctx:l}}}),t.$on("click",l[11]),{c(){R(e.$$.fragment),n=N(),R(t.$$.fragment)},l(o){V(e.$$.fragment,o),n=A(o),V(t.$$.fragment,o)},m(o,r){F(e,o,r),O(o,n,r),F(t,o,r),s=!0},p(o,r){const a={};r&128&&(a.rootMargin=1e3/Number(o[7])+"px"),e.$set(a);const i={};r&33554433&&(i.$$scope={dirty:r,ctx:o}),t.$set(i)},i(o){s||(b(e.$$.fragment,o),b(t.$$.fragment,o),s=!0)},o(o){k(e.$$.fragment,o),k(t.$$.fragment,o),s=!1},d(o){o&&d(n),M(e,o),M(t,o)}}}function Tl(l){let e,n;return e=new Yn({}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Pl(l){let e;return{c(){e=oe("Load more")},l(n){e=ie(n,"Load more")},m(n,t){O(n,e,t)},i:Y,o:Y,d(n){n&&d(e)}}}function Nl(l){let e,n;return e=new pt({}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Al(l){let e,n,t,s;const o=[Nl,Pl],r=[];function a(i,c){return i[0]?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=Ce()},l(i){n.l(i),t=Ce()},m(i,c){r[e].m(i,c),O(i,t,c),s=!0},p(i,c){let u=e;e=a(i),e!==u&&(ce(),k(r[u],1,1,()=>{r[u]=null}),ue(),n=r[e],n||(n=r[e]=o[e](i),n.c()),b(n,1),n.m(t.parentNode,t))},i(i){s||(b(n),s=!0)},o(i){k(n),s=!1},d(i){i&&d(t),r[e].d(i)}}}function zt(l){let e,n;return e=new bl({}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ol(l){let e,n,t,s,o,r,a,i,c,u,p,f,w,g,y,G,$,v,h;s=new hn({}),r=new Rn({props:{placeholder:"Search for tags",fetchSuggestions:l[9]}}),r.$on("pick",l[12]),i=new He({props:{title:"Search with the tags above",$$slots:{default:[yl]},$$scope:{ctx:l}}}),i.$on("click",l[10]),u=new $n({props:{tags:[...l[5],...l[4]]}}),u.$on("click",l[13]),u.$on("contextmenu",l[14]),u.$on("createSupertag",l[15]);const P=[El,Cl],U=[];function J(D,j){return D[1]?0:D[3].requested?1:-1}~(f=J(l))&&(w=U[f]=P[f](l));function B(D){l[16](D)}let T={tags:l[5]};l[2]!==void 0&&(T.dialog=l[2]),y=new qn({props:T}),we.push(()=>Fe(y,"dialog",B)),y.$on("submit",l[17]);let S=!l[8]&&zt();return{c(){e=C("meta"),n=N(),t=C("section"),R(s.$$.fragment),o=N(),R(r.$$.fragment),a=N(),R(i.$$.fragment),c=N(),R(u.$$.fragment),p=N(),w&&w.c(),g=N(),R(y.$$.fragment),$=N(),S&&S.c(),v=Ce(),this.h()},l(D){const j=_n("svelte-7jdp3v",ft.head);e=E(j,"META",{name:!0,content:!0}),j.forEach(d),n=A(D),t=E(D,"SECTION",{id:!0,class:!0});var I=L(t);V(s.$$.fragment,I),o=A(I),V(r.$$.fragment,I),a=A(I),V(i.$$.fragment,I),c=A(I),V(u.$$.fragment,I),I.forEach(d),p=A(D),w&&w.l(D),g=A(D),V(y.$$.fragment,D),$=A(D),S&&S.l(D),v=Ce(),this.h()},h(){ft.title="kurosearch - Rule34 Hentai",m(e,"name","description"),m(e,"content","Simple and powerful Rule34 browsing site with a focus on simplicity and user experience."),m(t,"id","search"),m(t,"class","svelte-nujk24")},m(D,j){_(ft.head,e),O(D,n,j),O(D,t,j),F(s,t,null),_(t,o),F(r,t,null),_(t,a),F(i,t,null),_(t,c),F(u,t,null),O(D,p,j),~f&&U[f].m(D,j),O(D,g,j),F(y,D,j),O(D,$,j),S&&S.m(D,j),O(D,v,j),h=!0},p(D,[j]){const I={};j&33554433&&(I.$$scope={dirty:j,ctx:D}),i.$set(I);const ee={};j&48&&(ee.tags=[...D[5],...D[4]]),u.$set(ee);let Q=f;f=J(D),f===Q?~f&&U[f].p(D,j):(w&&(ce(),k(U[Q],1,1,()=>{U[Q]=null}),ue()),~f?(w=U[f],w?w.p(D,j):(w=U[f]=P[f](D),w.c()),b(w,1),w.m(g.parentNode,g)):w=null);const z={};j&32&&(z.tags=D[5]),!G&&j&4&&(G=!0,z.dialog=D[2],Ve(()=>G=!1)),y.$set(z),D[8]?S&&(ce(),k(S,1,1,()=>{S=null}),ue()):S?j&256&&b(S,1):(S=zt(),S.c(),b(S,1),S.m(v.parentNode,v))},i(D){h||(b(s.$$.fragment,D),b(r.$$.fragment,D),b(i.$$.fragment,D),b(u.$$.fragment,D),b(w),b(y.$$.fragment,D),b(S),h=!0)},o(D){k(s.$$.fragment,D),k(r.$$.fragment,D),k(i.$$.fragment,D),k(u.$$.fragment,D),k(w),k(y.$$.fragment,D),k(S),h=!1},d(D){D&&(d(n),d(t),d(p),d(g),d($),d(v)),d(e),M(s),M(r),M(i),M(u),~f&&U[f].d(D),M(y,D),S&&S.d(D)}}}function Rl(l,e,n){let t,s,o,r,a,i,c,u,p;me(l,Ze,I=>n(3,t=I)),me(l,ut,I=>n(4,s=I)),me(l,Be,I=>n(19,o=I)),me(l,Ue,I=>n(20,r=I)),me(l,Bn,I=>n(21,a=I)),me(l,at,I=>n(5,i=I)),me(l,$t,I=>n(6,c=I)),me(l,Kt,I=>n(7,u=I)),me(l,tn,I=>n(8,p=I)),console.log(`%ckurosearch
%cHi, if you are reading this because you are debugging or reverse-engineering, feel free to send me a DM on Discord :)`,"color:crimson;font-size:32px;","color:unset;font-size:auto;");let f=!1,w,g,y=0;const G=async I=>{const ee=await Fn(I);return[...c.items.filter(({name:z})=>z.toLowerCase().includes(I.toLowerCase())).map(z=>({label:z.name,count:z.tags.length,type:"supertag"})),...ee]},$=()=>new An().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(r.property).withSortDirection(r.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(s),v=async I=>{if(!f){n(1,w=void 0),n(0,f=!0);try{const ee=t.pageCount;await I(),Ln(ee).catch(()=>{})}catch(ee){n(1,w=ee),console.warn(ee)}finally{n(0,f=!1)}}},h=async()=>{Ze.reset(),y=0,v(async()=>{const[I,ee]=await $().getPageAndCount();Ze.addPage(I,ee)})},P=async()=>{v(async()=>{const I=await $().getPage();Ze.addPage(I)})},U=I=>{var ee,Q;if((I.key==="/"||I.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((ee=document.getElementById("searchbar"))==null||ee.focus(),I.preventDefault(),I.stopPropagation()),I.ctrlKey&&I.key==="Enter"&&(I.preventDefault(),I.stopPropagation(),h()),I.ctrlKey&&I.key==="m"&&((Q=document.getElementById("select-modifier"))==null||Q.click()),I.ctrlKey&&I.key==="ArrowDown"){const z=document.getElementsByClassName("post-media");z[y].focus(),y=Math.min(y+1,Math.max(0,z.length-1))}I.ctrlKey&&I.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[y].focus(),y=Math.max(y-1,0))};ot(async()=>{document.addEventListener("keydown",U),t.postCount===0&&h()}),it(()=>{document.removeEventListener("keydown",U)});const J=async I=>{const ee=I.detail;if(ee.type==="supertag"){const Q=c.items.find(z=>z.name===ee.label);if(!Q){console.warn("Supertag not present.");return}ut.addOrReplace(Q)}else{const Q=await Mn(I.detail.label);at.addOrReplace({name:I.detail.label,modifier:I.detail.modifier,count:I.detail.count,type:(Q==null?void 0:Q.type)??"tag"})}},B=I=>"description"in I.detail?ut.removeByName(I.detail.name):at.removeByName(I.detail.name),T=I=>{"description"in I.detail||(I.detail.modifier=jn(I.detail.modifier),at.addOrReplace(I.detail))},S=()=>{g.showModal(),qt("dialog")};function D(I){g=I,n(2,g)}return[f,w,g,t,s,i,c,u,p,G,h,P,J,B,T,S,D,I=>$t.add(I.detail)]}class ar extends pe{constructor(e){super(),_e(this,e,Rl,Ol,fe,{})}}export{ar as component};
